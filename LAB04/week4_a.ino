#define PI 3.1415926535897932384626433832795
double y[75]={-87.17307638,-109.5495333,11.00037444,163.4286511,199.1497693,123.5660003,56.25558579,11.87495703,-18.97729813,-42.98507139,-49.50432452,-44.95819516,-33.93206642,-28.58275615,-31.58109989,-41.0802992,-54.49307368,-68.26273259,-80.63560247,-89.53265601,-97.96825536,-104.8688265,-109.0354357,-55.42792547,102.4289065,215.9352907,173.6592794,95.27713062,38.69934301,2.586699113,-27.11808597,-41.50592056,-38.88116345,-27.52106187,-19.43972127,-21.31888102,-29.19861314,-42.08703327,-57.83191118,-69.53303635,-80.46281953,-88.35226795,-94.97094082,-102.2065852,-97.71319214,4.172319927,174.7275931,221.5697151,147.842936,75.61863429,28.48903346,-4.64088307,-29.76995187,-35.85962812,-27.26819387,-12.26373734,-5.602559446,-9.189517172,-21.48116953,-38.07938735,-52.01784737,-63.35879895,-71.93471855,-79.04261272,-85.4265121,-86.88364206,-9.984335526,167.9810654,251.6113399,182.1367896,108.0062751,59.54909365,24.89964724,-5.472668004,-17.77934267
};
double x[75];
int N = 75;
//int n,k;
//double real = cos((-1*2*PI*k*n)/N);
//double img = sin((-1*2*PI*k*n)/N);
double real_w[75][75];
double img_w[75][75];
double dft_real[75],dft_img[75],dft_mag[75];
void setup() {
  // put your setup code here, to run once:
Serial.begin(9600);

for(int i=0;i<75;i++){
  for(int j=0;j<6;j++){
    x[i]= x[i]+ y[i-j];
  }
  x[i]=x[i]/6;
 
}

for(int i=0;i<N;i++){
  for(int j=0;j<N;j++){
    real_w[i][j] = cos((-1*2*PI*i*j)/N);
    img_w[i][j] = sin((-1*2*PI*i*j)/N);
  }
}
for(int i=0;i<N;i++){
  int sum_real=0,sum_img=0;
  for(int j=0;j<N;j++){
    sum_real = sum_real+real_w[i][j]*x[j];
    sum_img = sum_img+img_w[i][j]*x[j];
  }
  dft_real[i] = sum_real;
  dft_img[i] = sum_img;
  dft_mag[i] = sqrt((sum_real*sum_real)+(sum_img*sum_img));
  //Serial.println(dft_mag[i]);
}

int maxk = 0;
for(int i=0;i<N/2;i++){
  if(dft_mag[maxk] < dft_mag[i]){
    maxk = i;
  }
}

float fmax = maxk*25;
fmax = fmax/75;
float bpm = fmax*60;
Serial.println(maxk);
Serial.println(fmax);
Serial.println(bpm);


 
}

void loop() {
  // put your main code here, to run repeatedly:

}
