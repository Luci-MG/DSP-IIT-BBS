clc;
clear all;
close all;
x = [-293.9933169,-571.4949447,-287.7493388,407.5377746,670.4527126,447.1220561,47.47038224,-286.5789079,-250.7585214,-214.6878241,-282.2894898,-368.3435895,-434.1230443,-475.2901492,-517.0370593,-327.0907589,379.2938826,664.7190269,485.5750664,94.5193723,-250.3408215,-229.9929105,-189.6067643,-244.5593751,-332.127081,-399.7188767,-304.0448543,-144.7803093,-289.8445669,-514.4135883,-509.7222374,-461.9822547,-489.8982152,-520.9526478,-548.4732808,-580.0677935,-478.2931334,338.7401462,784.1842548,598.5528323,268.3626935,-140.8247299,-191.2765855,-111.9508138,-186.5600831,-278.2835464,-358.0432071,-403.146297,-385.4524578,244.647301,822.0299217,714.1940601,414.9182324,-23.97427964,-194.9495692,-121.358183,-155.7861059,-258.6165315,-331.2556868,-407.2899169,-432.8609441,-435.237033,196.2647371,881.2945764,810.353181,532.4929804,86.65015877,-147.8088341,-101.5029976,-123.7840301,-228.501058,-314.0142919,-388.5081475,-416.9710204,-450.1961878,-0.30528414,668.2853521,679.359014,386.9009338,-69.14824853,-248.9252639,-173.8279896,-192.1336289,-288.8260406,-373.235325,-440.9128412,-302.5303534,12.56725632,-56.80943454,-403.8184511,-539.7371492,-477.8240647,-471.4955748,-497.8428485,-554.420454,-585.093314,-637.7288561,-220.4507426,454.5975586,446.778403,92.91304738,-337.4070183,-381.2174207,-274.4822979,-296.0672927,-377.2841286,-453.9797353,-511.146965,-549.2601844,-405.166521,315.2638983,658.3079582,463.1566385,69.6660808,-269.4369671,-235.5105211,-184.4253627,-245.1809953,-337.628247,-421.5492711,-450.9557551,-492.1462598,-209.3081246,592.5115708,803.2148276,582.8057061,202.3563733,-144.12897,-141.8879457,-110.2868273,-205.1180852,-298.0179277,-380.3354849,-413.2725798,-450.1955749,-28.87605529,709.1588972,776.8130292,535.6429491,130.5416285,-170.4292271,-128.4406715,-125.6903576,-216.4807721,-286.2292092,-383.4596039,-429.9790104,-474.4948204,-86.40486673,714.4464206,822.03179,582.9167929,197.053234,-152.4870782,-152.6507969,-126.4794304,-218.6965063,-307.9416387,-386.7679247,-426.4815608,-473.4044747,-184.5684039,576.6333498,751.195138,517.5562221,105.8589521,-218.703229,-187.751773,-164.2868174,-245.8560303,-340.4601233,-409.2961804,-455.9224891,-490.6994314,-353.4391531,383.9804291,738.2939602,544.2139283,163.6275343,-221.1588051,-236.9446331,-189.9249401,-249.674731,-345.2123748,-425.0142736,-474.6654084,-516.2121747,-383.5220959,302.9805888,637.6726885,461.2554365,68.86219908,-302.270753,-284.3961392,-230.699813,-286.1233864,-383.9423517,-443.3172708,-502.572553,-517.1903106,-507.4352824,45.93285754,667.2943761,636.1283649,356.179755,-79.19261095,-234.9759353,-165.7530372,-180.4524048,-268.7361811,-347.7821514,-413.2180624,-436.6378515,-470.9105337,-162.6225314,597.9023266,765.8701632,546.9696164,165.9897128,-154.3145219,-123.4350406,-98.9627069,-195.0802008,-269.3450813,-352.4607048,-394.4231238,-432.7155233,-93.04414932,665.6590449,795.5354831,561.8921232,185.7087129,-161.0649486,-155.3883973,-134.0377678,-228.1645428,-311.2616199,-391.5132612,-438.9585686,-482.7414714,-253.7664022,514.1359644,777.9324968,583.0510379,208.8112259,-169.7954989,-179.3777607,-136.0273815,-209.0337782,-311.102072,-374.1206469,-436.2531097,-451.1766079,-463.3427741,69.83254731,725.9077551,688.7566359,399.8214067,-47.13225854,-220.2146892,-146.244451,-165.1596469,-266.2945961,-352.9371225,-420.9298208,-445.6975656,-455.0318523,39.89793862,623.1725505,586.3230063,274.8045456,-166.6082192,-278.0199736,-204.1578942,-227.5966241,-320.0355377,-395.9134732,-464.8176268,-491.0471175,-524.4713122,-112.6240624,598.1304494,665.2389226,409.4399512,-28.70471165,-267.2063705,-199.383687,-196.0659978,-282.2367715,-361.7169403,-427.6036377,-459.7273944,-494.3218683,-142.1025127,551.2426418,668.9208888,439.1361438,17.91122083,-230.014612,-165.8627599,-154.8829429,-236.0476106,-322.2847729,-384.9387939,-423.4866907,-449.2008853,-265.6686509,519.5575291,870.1305383,693.3734079,379.4392393,-30.36935188,-100.5654629,-41.74570346,-118.79673,-212.3608356,-278.6795536,-344.9309726,-367.0751788,-329.7334206,306.6592167,833.7022329,721.0938124,439.2692966,4.658803938,-175.9518457,-111.1290595,-156.4288534,-259.973228,-338.7251762,-409.0899355,-449.315225,-399.1780962,251.1675769,751.6294796,636.3852924,321.5681623,-105.6703063,-207.7763917,-140.231937,-183.8245961,-284.7913905,-359.6001987,-419.8654457,-451.1820483,-419.5808026,205.8263984,751.6521046,657.2827566,341.7254426,-97.97531398,-204.1571683,-137.2273016,-178.1921703,-277.3246845,-353.6887305,-416.5281152,-444.0496315,-437.5370075,132.9583762,721.1196399,664.3390436,365.7579489,-85.03736295,-225.1387115,-157.4556999,-193.7095666,-290.7202392,-368.1193761,-433.7697879,-462.9017334,-507.1533705,-199.0793954,550.1548736,721.4494204,500.7823314,79.55304984,-235.4237064,-192.1923967,-171.946875,-251.0190848,-342.338576,-406.1030029,-458.4984383,-481.8804643,-385.7110904,282.9437132,727.0085164,604.667332,269.0685586,-139.2259933,-188.3566862,-125.4353402,-173.5430258,-273.3114497,-344.7882952,-400.868706,-420.6383644,-356.5656926,310.0729322,825.4324211,716.0906181,431.7657677,10.70832868,-121.1944295,-48.96583253,-103.72085,-202.2353943,-269.5650785,-340.8900081,-379.3078417,-367.8913235,263.399983,837.4931744,743.0339892,471.178191,35.65554078,-167.5626828,-108.6341522,-146.2392277,-255.4415165,-330.7963296,-405.1576036,-436.4494812,-470.5456801,-42.23024808,682.3327525,739.331967,490.3933427,68.90831537,-201.6794108,-146.1921971,-141.1934191,-238.2060187,-325.7979063,-397.363441,-426.5860826,-460.4893011,-56.3380268,639.5264997,707.5701355,454.638319,15.6399291,-214.928638,-148.685331,-149.2647299,-241.9775466,-325.5686957,-396.7204105,-267.9049197,237.7600348,404.6908908,107.070852,-308.5186598,-375.7229532,-288.2353847,-301.5814241,-382.5683009,-451.8667418,-514.932156,-341.2506636,252.638298,414.5802726,56.30502494,-376.0500973,-405.348488,-297.9690445,-319.0324762,-396.485995,-472.7866458,-532.778983,-466.3834096,182.1163072,624.7048586,482.7784999,106.4408237,-264.0203706,-257.0038146,-184.5061337,-235.4682488,-324.6590788,-398.8923374,-436.2514996,-473.3318037,-250.6036707,614.682746,959.5184451,768.0037754,438.8864964,19.15664078,-60.80754309,-8.943230619,-85.31965839,-190.8352621,-257.4781582,-309.1282642,-341.6781466,-209.4532344,551.9322635,976.7864349,814.3590613,516.1082728,68.17292899,-85.4413118,-46.69515621,-131.2023771,-238.5141759,-310.63679,-386.1432053,-424.3934587,-386.5604974,293.6413622,852.2374026,736.2457727,445.1056008,-7.00813911,-191.3082158,-126.7737179,-165.9736063,-271.7124596,-352.2517281,-425.3883801,-458.9013675,-455.0139261,116.5290753,718.485957,657.9228565,355.6423743,-86.73745272,-224.5030801,-152.1901575,-182.3677576,-272.0806737,-358.1542663,-375.2860941,-239.114437,-229.8414159,-449.8015773,-534.039556,-485.6674968,-492.6039473,-522.6264473,-563.6183664,-569.7597129,-626.4856763,-144.5235972,655.9331846,679.3379082,405.2689967,-41.53768525,-256.6964007,-183.2921065,-184.2477174,-276.8904254,-366.1734339,-437.794241,-476.9133336,-445.9770928,201.4774736,748.0972487,636.1238168,294.122576,-151.9978135,-236.6265292,-163.6132087,-204.570364,-300.9988043,-375.7241193,-451.0239056,-473.4062689,-471.3890386,99.4535776,776.8350792,741.3746952,455.2671371,6.154989943,-185.5810689,-116.3217528,-130.7957638,-226.2363895,-304.0123447,-374.988045,-397.522995,-419.5981258,35.80647173,774.7270151,826.9621354,594.8005739,195.7734303,-102.6761224,-61.58947749,-62.32407716,-156.9759756,-237.1666306,-327.9565194,-380.1522116,-415.1042812,-217.0513683,589.3761755,910.2842725,718.4243635,386.5515021,-32.53972163,-115.8048546,-69.79986591,-146.8957733,-247.1842404,-323.877424,-380.7228512,-425.8108594,-304.5779448,397.2858747,757.6734007,585.9125082,216.6273379,-192.3571372,-220.072159,-167.5094712,-228.6261202,-328.8061036,-399.4627006,-462.3034716,-488.9565653,-479.5507874,110.2990923,695.0367329,621.3563073,302.1246027,-144.0664968,-263.3391449,-188.9026121,-217.1788005,-308.4701502,-376.8293358,-436.7040433,-471.9318796,-470.1819867,52.99655205,624.31205,588.1567224,279.20128,-157.6554511,-257.3911075,-182.072638,-209.116561,-292.737595,-379.797302,-372.188236,-197.5774622,-206.2734241,-456.3529294,-542.5662453,-484.324389,-493.5188228,-521.8086889,-564.0644481,-575.8898347,-631.970886,-163.37353,652.4751029,701.302554,435.9819545,-4.877132977,-244.5477135,-165.5455256,-165.5151072,-253.5241109,-357.327481,-412.0623235,-478.4660629,-221.030689,513.318253,724.5734401,511.9825402,83.00305428,-235.9338801,-194.048452,-161.4727618,-240.3686403,-320.9556471,-388.69353,-135.975996,281.0968676,219.4479101,-193.0577153,-421.6801323,-330.7177513,-309.7190423,-354.0071172,-418.9837066,-458.1536263,-462.5740332,217.6126803,849.528523,722.1999555,393.6347283,-42.99024333,-133.8729187,-47.3279211,-116.041733,-222.4747994,-320.2788201,-378.1033255,-415.9003182,-216.8424556,611.2726569,929.1888683,716.7174169,357.3680793,-59.83883476,-114.6878729,-67.94372001,-151.053961,-254.0711116,-341.2395628,-383.9959523,-440.2284421,-165.0387325,632.6630175,827.3808945,585.1597965,162.1219237,-181.6051251,-159.5748572,-137.0219926,-225.3068001,-323.8443135,-404.9914801,-441.4729295,-493.5773731,-170.6527244,569.0462841,704.4627027,448.4933288,-2.816473155,-274.4811566,-207.6751979,-196.2221966,-278.5228862,-363.8876072,-421.6298748,-465.390668,-506.2817604,-341.1541882,418.7887782,760.7691335,574.9055267,188.1593344,-191.0241869,-192.5122974
];
km=[-698.0343979,-1267.833155,-1118.175888,-1183.593906,-1107.586657,-1118.745783,-1079.474977,-1077.56509,-1058.12421,-1046.55206,-1040.400821,-1041.421142,-1053.322285,-1093.769487,-1135.128221,-1152.196007,-1153.388658,-1134.772922,-1110.09643,-1083.545432,-1032.976192,-940.3613968,-840.6837543,-732.1040015,-634.8257239,-548.3217209,-468.2112715,-382.9338903,-284.4401434,-181.0979537,-91.82041798,-18.85822747,50.7292172,107.7566459,143.0243309,148.4369663,149.0405911,166.9380942,202.0808509,253.025502,305.9468951,362.6865362,418.8021521,475.7704362,542.0188839,608.7244041,649.4557583,660.9212554,653.6931742,637.288456,608.5758222,553.5270245,489.2695676,426.192433,359.080019,289.0381993,211.4527893,139.009908,70.8487741,-16.93049917,-126.9884786,-244.0282061,-338.5969355,-423.1656516,-499.333299,-576.8213476,-649.5188176,-710.069992,-759.1655966,-811.068302,-859.288217,-910.9569738,-987.6324951,-1068.561365,-1138.937189,-1193.174318,-1223.819783,-1229.646788,-1229.03525,-1234.758993,-1247.849507,-1257.72571,-1272.51338,-1283.685474,-1284.394582,-1294.492844,-1290.680775,-1266.299204,-1232.231359,-1202.889575,-1181.809819,-1168.765769,-1162.456036,-1158.62752,-1153.668873,-1148.81966,-1150.326766,-1152.315284,-1158.80833,-1151.730915,-1124.430138,-1098.295715,-1077.553986,-1067.77127,-1065.410277,-1066.401434,-1085.637916,-1115.199439,-1143.710038,-1157.876977,-1155.305916,-1136.124737,-1115.606843,-1061.727609,-968.7639246,-862.5664456,-750.2196288,-634.7312329,-526.9092739,-447.2571359,-380.5743135,-324.7175043,-280.1619856,-223.9457287,-161.3956949,-99.1836327,-42.47651681,8.23447341,73.3750062,140.4579918,208.6766821,278.3955643,329.7040827,355.3717816,362.8537677,374.171912,405.4228764,447.9760066,487.8997987,532.8286887,586.1777705,630.7715521,651.5248964,648.1058434,627.8228937,570.3944763,473.203345,349.3181758,222.7595663,109.041823,15.66873583,-66.35796055,-134.7926427,-196.9660691,-252.5906891,-315.3594263,-374.3047175,-436.66925,-505.4668085,-589.5454903,-685.534105,-768.3885696,-838.4783624,-902.9600898,-970.1947312,-1022.871694,-1058.455611,-1086.609438,-1120.004294,-1146.867104,-1174.463501,-1200.416819,-1241.552159,-1297.816974,-1330.153721,-1351.937292,-1354.406143,-1347.972521,-1337.439486,-1324.888586,-1295.378877,-1260.33379,-1232.91496,-1212.502004,-1204.427529,-1212.807504,-1220.804778,-1213.052596,-1197.299236,-1173.698482,-1157.406614,-1137.052225,-1115.543607,-1098.653785,-1077.815332,-1061.227808,-1048.066697,-1034.137724,-1016.149284,-973.1533059,-914.7391626,-851.4279282,-762.5428739,-664.0199619,-572.2089011,-478.8153234,-377.2910252,-282.115671,-189.9100579,-105.9200536,-37.0818105,17.93921097,40.16593441,47.60572209,67.84239273,96.85704781,135.3563379,183.8244449,235.207436,279.8128441,333.7384128,391.627591,439.8923391,477.3510706,507.8965051,527.254586,527.1362963,497.021902,456.3691022,414.6555703,364.6970465,303.6153231,242.5381081,184.6062914,123.5394888,55.51035618,-19.92325982,-91.13896512,-177.5728629,-267.5972825,-346.5429745,-424.99836,-493.3447399,-555.7831824,-612.6921274,-663.3023601,-709.0501372,-751.4617913,-799.4324583,-846.88234,-896.7251373,-964.138115,-1041.690453,-1110.402159,-1167.044816,-1208.589432,-1225.866942,-1236.783974,-1241.971622,-1245.003513,-1248.9759,-1265.778211,-1285.056545,-1297.848472,-1317.722041,-1352.310392,-1383.388747,-1396.814918,-1388.708258,-1380.777392,-1371.369053,-1355.165861,-1337.650597,-1306.677276,-1267.383488,-1232.615481,-1213.569402,-1207.31415,-1208.761767,-1203.428459,-1190.821724,-1168.479159,-1137.465521,-1121.331266,-1103.650813,-1072.615002,-1032.051725,-977.1926645,-884.9021304,-789.7080532,-712.2436765,-651.6216297,-599.6104475,-548.9030734,-477.067707,-382.8310441,-289.4731329,-201.4604871,-115.3762507,-23.57817288,52.42173389,109.6891074,168.3171858,228.3674701,267.8957643,284.8547537,291.3777711,301.5878228,328.2973266,356.8504392,385.8995971,425.6688645,473.3651037,528.199059,570.6653237,607.2249439,629.6508383,600.4420516,517.3485642,403.4281462,290.0799543,194.3240204,109.4570908,35.3183753,-26.74999265,-77.40816034,-128.0619148,-182.7382542,-230.3438885,-275.7627008,-336.1190756,-413.894609,-490.251737,-557.8444332,-601.667017,-638.8924182,-674.1454333,-704.4098458,-738.0918681,-768.031216,-809.7222288,-855.1901368,-901.5061313,-962.455109,-1034.952128,-1102.814942,-1142.24613,-1163.605998,-1174.006499,-1189.484128,-1212.238304,-1230.056744,-1244.978645,-1256.42705,-1268.056486,-1278.42996,-1301.109712,-1337.262559,-1369.228734,-1386.948897,-1382.113156,-1367.408042,-1355.09345,-1342.137969,-1320.026123,-1286.438028,-1254.409642,-1231.531344,-1211.976115,-1202.997965,-1208.822797,-1203.497448,-1184.99708,-1161.256738,-1137.726892,-1121.248103,-1104.420745,-1081.906885,-1042.501837,-975.4171334,-883.6941751,-776.0674981,-680.6554446,-603.815614,-538.5292691,-488.6817869,-433.1456269,-363.5850149,-279.745708,-190.9232914,-100.9245437,-11.05612672,70.45632069,131.3401787,191.966086,253.0239951,291.6265731,302.6652119,305.5929951,309.7218653,324.8616061,354.2335396,385.018107,426.5509924,478.6420831,532.0663038,581.030451,606.3615127,596.0935664,545.1836302,447.269937,331.9829861,219.0307403,126.8558334,44.05612897,-35.24319516,-92.2552146,-132.2922552,-169.4556986,-215.1146303,-276.3102148,-332.7516146,-389.3475062,-454.5181102,-525.2890139,-589.6374905,-631.5414696,-663.5701816,-691.4310782,-719.7819869,-747.4804855,-771.5729983,-798.9813127,-835.1715992,-867.4203031,-919.5469944,-993.833498,-1055.098261,-1096.117828,-1127.463035,-1151.074709,-1173.444881,-1191.377362,-1198.955235,-1204.040088,-1210.146381,-1222.672646,-1241.890858,-1262.220678,-1279.969688,-1284.110944,-1269.201979,-1251.413482,-1235.048526,-1231.120051,-1247.142774,-1268.650033,-1287.024112,-1285.346946,-1276.547075,-1268.528934,-1259.558224,-1246.824311,-1216.282125,-1181.378974,-1150.424423,-1126.4281,-1101.442054,-1081.162188,-1074.339873,-1054.844862,-1000.035585,-916.8457659,-808.7901911,-712.6236019,-610.9623568,-508.9838922,-412.508755,-315.3796261,-227.314327,-131.2145572,-38.82755098,34.15636471,85.1889466,115.6136911,137.0329471,168.3507665,208.5664462,261.3911471,327.0237765,394.4834982,457.8658633,511.4421871,563.0807467,607.7139179,629.1146666,629.2507355,622.6234634,618.9795222,618.4582942,603.8531559,550.3575614,460.7364732,375.4707829,293.9264912,203.3306759,124.6849118,50.16771481,-32.69742262,-123.49661,-209.7035005,-288.2196984,-349.4564962,-397.3674618,-443.495958,-479.8332472,-510.3692163,-526.5320976,-543.542132,-565.1674012,-588.4471546,-626.7381591,-677.9391815,-731.0365334,-793.9484375,-841.1733885,-875.9558328,-914.4535901,-944.4092317,-964.5616763,-994.6308964,-1034.36089,-1067.694526,-1104.729764,-1131.127932,-1148.357757,-1159.31283,-1162.22889,-1183.521103,-1218.291018,-1244.364083,-1265.28404,-1300.259418,-1339.420792,-1378.3011,-1401.370013,-1416.434429,-1431.75211,-1442.170764,-1444.449294,-1421.396057,-1381.398037,-1343.591137,-1308.642823,-1280.489509,-1270.071212,-1262.492561,-1242.437429,-1219.461013,-1183.219444,-1142.49543,-1088.30146,-1006.602173,-903.3453573,-776.2116907,-671.4215837,-575.3255667,-477.0943173,-395.1692846,-324.740434,-263.1957867,-206.7386443,-151.4435743,-87.90225504,-19.38112123,58.29569001,131.0037874,198.8123414,264.1921051,323.8839506,378.1054973,425.7590211,444.6396586,440.8588879,428.7719059,430.1055173,452.1921582,482.1569322,514.4621322,560.3529189,608.4363191,625.2157352,602.4121957,553.4120518,486.1290338,389.2155843,270.6588797,143.2972536,23.41912836,-72.72753033,-169.9317861,-269.5879224,-348.5762107,-417.9481516,-490.9555218,-564.9951639,-637.4143731,-711.9359514,-810.6264887,-912.8158378,-989.4387159,-1050.827867,-1074.64957,-1084.458372,-1092.429291,-1088.16881,-1075.249195,-1059.267054,-1048.100978,-1045.85052,-1049.035948,-1073.627136,-1110.463804,-1130.95258,-1139.28066,-1132.986547,-1119.46255,-1108.159703,-1102.44413,-1089.674897,-1061.2694,-1041.247347,-1054.785366,-1078.967214,-1115.390997,-1161.064243,-1195.35079,-1210.68587,-1209.465422,-1207.409955,-1210.667552,-1209.854639,-1204.334032,-1198.017182,-1196.131967,-1191.556434,-1200.932621,-1210.060189,-1211.050647,-1199.244833,-1183.850756,-1174.94862,-1179.13261,-1191.823151,-1202.834531,-1222.64488,-1248.831517,-1279.003814,-1299.536326,-1301.7628,-1297.811422,-1285.628902,-1260.582147,-1231.26631,-1204.132496,-1178.025126,-1146.627977,-1119.185276,-1081.057987,-1011.036276,-917.9527205,-808.458666,-689.2248495,-573.7849396,-484.6862517,-389.016214,-274.6163736,-159.5862665,-59.89590897,13.83155105,56.83762085,85.80448165,132.755022,212.8331291,284.7263144,342.2097098,401.2554905,454.4157694,502.8182765,541.6440591,548.3892943,531.1113899,519.1231053,525.6133525,552.7106971,582.9595437,616.1108638,642.4710103,644.1618028,615.479944,562.9247458,491.2733099,395.3165485,272.083247,154.2057215,46.71213745,-62.86510011,-155.0267318,-235.1988851,-303.1029808,-369.2109323,-433.4975398,-498.50461,-570.0607983,-644.0311424,-726.9997898,-807.6785082,-868.0505256,-919.0023525,-948.3003059,-968.2149763,-985.6942584,-983.8129708,-975.8931293,-978.9246161,-994.9866777,-1009.778071,-1035.052831,-1072.533867,-1096.082662,-1103.900549,-1105.15619,-1099.842625,-1095.172444,-1089.709936,-1080.623572,-1062.901655,-1048.083577,-1055.175364,-1064.053716,-1080.382893,-1119.647062,-1168.398395,-1192.537597,-1197.454855,-1192.513878,-1187.547491,-1178.783825,-1169.98022,-1161.571367
];
fs=25;
N=length(x);
L=10;
%Moving average filtering
% for i=1:750
%     sum=0;
%     if(i-L>0)
%     for j=i-L:i
%         sum=sum+x(j);
%     end
%     end
%     y(i)=sum/L;
% end


%Computing DFT
for k=1:750
    sum=0;
    for n=1:750
        sum=sum+x(n)*exp(-1i*2*pi*k*n/N);
    end
   X(k)=sum;
end

k=1:750;
X=abs(X);
subplot(2,1,1);plot(k,X);title('Magnitude Response Of PPG signal');xlabel('k');ylabel('MAGNITUDE');grid on; axis tight;

%Finding the First Maximum
max=0;
max2=0;
for i=1:380
    if(X(i)>max)
        max=X(i);
        peak_index=i;
    end
end
BPM=peak_index*25*60/750;
fprintf('BPM USING DFT: %d \n', BPM);

%Finding the First Maximum
max=0;
max2=0;
for i=1:15
    if(X(i)>max)
        max=X(i);
        peak_index=i;
    end
end
BPM=peak_index*25*60/750;
fprintf('RESPIRATION RATE: %d \n', BPM);

%PART-2
%AUTOCORRELATION FUNCTION
for m=1:750
    sum=0;
    for n=1:750-m-1
        sum=sum+x(n)*x(n+m);
    end
    r(m)=sum;
end
norm=r(1);
for i=1:750
    r(i)=r(i)/norm;
end
subplot(2,1,2);
plot(r);title('Autocorrelation Of PPG signal');xlabel('t(in seconds)');ylabel('Autocorrelation');grid on; axis tight;


%Finding Zero Crossing Point
for i=1:750
    if(r(i)*r(i+1)<0)
        zcr=i;
        break
    end
end

%Finding the peak indexcafter ZCR
peak=0;
for i=zcr+1:750
    if(r(i)>peak)
        peak=r(i);
        peak_index2=i;
    end
end
BPMa=(60*25)/peak_index2;
fprintf('BPM USING AUTOCORRELATION: %f \n', BPMa);


%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%  INBUILT FFT PPG

dft = fft(x);
dft_matrix = dftmtx(size(x,2));

figure;
plot(abs(dft));
xlabel('Frequency');
ylabel('Magnitude');
title('Magnitude Response USING INBULT FFT');grid on; axis tight;
dft = abs(dft);
%Finding the First Maximum
max=0;
max2=0;
for i=1:380
    if(dft(i)>max)
        max=dft(i);
        peak_index=i;
    end
end
BPM=peak_index*25*60/750;
fprintf('BPM USING INBUILT FFT: %d \n', BPM);

%Finding the First Maximum
max=0;
max2=0;
for i=2:15
    if(dft(i)>max)
        max=dft(i);
        peak_index=i;
    end
end
BPM=peak_index*25*60/750;
fprintf('RESPIRATION RATE USING INBUILT FFT: %d \n', BPM);

%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%  INBUILT FFT ORGINAL RESPIRATION

dft = fft(km);
dft_matrix = dftmtx(size(km,2));

figure;
plot(abs(dft));
xlabel('Frequency');
ylabel('Magnitude');
title('Magnitude Response USING INBULT FFT');grid on; axis tight;

dft = abs(dft);
%Finding the First Maximum
max=0;
max2=0;
for i=2:15
    if(dft(i)>max)
        max=dft(i);
        peak_index=i;
    end
end
BPM=peak_index*25*60/750;
fprintf('RESPIRATION RATE USING INBUILT FFT ORGINAL: %d \n', BPM);
lm = [];
figure;
hey = fft(x);
for i = 1:750
    if(i < 15 && i > 735)
        lm(i)  = hey(i);
    else
        lm(i) = 0;
    end
end
heyi = ifft(lm);
subplot(3,1,1);
plot(x);grid on; axis tight;title('ORIGINAL PPG');
subplot(3,1,2);
plot(heyi);grid on; axis tight;title('RESPIARTORY PLOT FROM PPG');
subplot(3,1,3);
plot(km);grid on; axis tight;title('ORIGINAL RESPIRATORY');